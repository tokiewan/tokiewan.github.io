<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>–ü–æ–π–º–∞–π –∫–≤–∞–¥—Ä–∞—Ç</title>
<style>
    body {
        font-family: Arial, sans-serif;
        background: #1e1e2f;
        color: white;
        display: flex;
        flex-direction: column;
        align-items: center;
    }

    h1 {
        margin: 10px;
    }

    .info {
        display: flex;
        gap: 40px;
        margin-bottom: 20px;
    }

    .circle {
        width: 120px;
        height: 120px;
        border-radius: 50%;
        border: 6px solid #4cafef;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 20px;
        text-align: center;
    }

    #gameArea {
        width: 500px;
        height: 500px;
        background: #2a2a40;
        position: relative;
        border: 4px solid #4cafef;
    }

    #target {
        position: absolute;
        cursor: pointer;
        transition: 0.2s;
    }

    .score, .record {
        font-size: 22px;
        margin-top: 10px;
    }

    button {
        margin-top: 15px;
        padding: 10px 20px;
        font-size: 16px;
        cursor: pointer;
    }
</style>
</head>
<body>

<h1>–ü–æ–π–º–∞–π –∫–≤–∞–¥—Ä–∞—Ç</h1>

<div class="info">
    <div class="circle" id="gameTimer">60 —Å–µ–∫</div>
    <div class="circle" id="clickTimer">7 —Å–µ–∫</div>
</div>

<div id="gameArea">
    <div id="target"></div>
</div>

<div class="score">–û—á–∫–∏: <span id="score">0</span></div>
<div class="record">–†–µ–∫–æ—Ä–¥: <span id="record">0</span></div>

<button onclick="startGame()">–ù–∞—á–∞—Ç—å –∏–≥—Ä—É</button>

<script>
let score = 0;
let gameTime = 60;

let clickTime = 7;
let baseClickTime = 7;
let minClickTime = 2;

let gameInterval, clickInterval;
let gameRunning = false;

const target = document.getElementById("target");
const gameArea = document.getElementById("gameArea");
const scoreEl = document.getElementById("score");
const recordEl = document.getElementById("record");
const gameTimerEl = document.getElementById("gameTimer");
const clickTimerEl = document.getElementById("clickTimer");

// –∑–∞–≥—Ä—É–∑–∫–∞ —Ä–µ–∫–æ—Ä–¥–∞
let record = localStorage.getItem("squareGameRecord");
record = record ? Number(record) : 0;
recordEl.textContent = record;

// —Å–ª—É—á–∞–π–Ω—ã–π —Ü–≤–µ—Ç
function randomColor() {
    return `hsl(${Math.random() * 360}, 80%, 60%)`;
}

// —Å–ª—É—á–∞–π–Ω—ã–π —Ä–∞–∑–º–µ—Ä
function randomSize() {
    return Math.floor(Math.random() * 40) + 30;
}

// —Å–ª—É—á–∞–π–Ω–∞—è –ø–æ–∑–∏—Ü–∏—è
function randomPosition() {
    const maxX = gameArea.clientWidth - target.clientWidth;
    const maxY = gameArea.clientHeight - target.clientHeight;

    target.style.left = Math.random() * maxX + "px";
    target.style.top = Math.random() * maxY + "px";
}

// –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–≤–∞–¥—Ä–∞—Ç–∞
function updateTarget() {
    const size = randomSize();
    target.style.width = size + "px";
    target.style.height = size + "px";
    target.style.background = randomColor();
    randomPosition();
}

// —Ç–∞–π–º–µ—Ä –∫–ª–∏–∫–∞
function startClickTimer() {
    clearInterval(clickInterval);
    clickTime = baseClickTime;
    clickTimerEl.textContent = clickTime.toFixed(1) + " —Å–µ–∫";

    clickInterval = setInterval(() => {
        clickTime -= 0.1;
        clickTimerEl.textContent = clickTime.toFixed(1) + " —Å–µ–∫";

        if (clickTime <= 0) {
            score -= 3;
            scoreEl.textContent = score;
            updateTarget();
            startClickTimer();
        }
    }, 100);
}

// –∫–ª–∏–∫ –ø–æ –∫–≤–∞–¥—Ä–∞—Ç—É
target.onclick = (e) => {
    e.stopPropagation();
    if (!gameRunning) return;

    score += 5;
    scoreEl.textContent = score;

    if (baseClickTime > minClickTime) {
        baseClickTime -= 0.3;
    }

    updateTarget();
    startClickTimer();
};

// –º–∏—Å—Å–∫–ª–∏–∫ –ø–æ –ø–æ–ª—é
gameArea.onclick = () => {
    if (!gameRunning) return;
    score -= 1;
    scoreEl.textContent = score;
};

// —Å—Ç–∞—Ä—Ç –∏–≥—Ä—ã
function startGame() {
    if (gameRunning) return;

    gameRunning = true;
    score = 0;
    gameTime = 60;
    baseClickTime = 7;

    scoreEl.textContent = score;
    gameTimerEl.textContent = gameTime + " —Å–µ–∫";

    updateTarget();
    startClickTimer();

    gameInterval = setInterval(() => {
        gameTime--;
        gameTimerEl.textContent = gameTime + " —Å–µ–∫";

        if (gameTime === 0) {
            clearInterval(gameInterval);
            clearInterval(clickInterval);
            gameRunning = false;

            if (score > record) {
                record = score;
                localStorage.setItem("squareGameRecord", record);
                recordEl.textContent = record;
                alert("üéâ –ù–æ–≤—ã–π —Ä–µ–∫–æ—Ä–¥!\n–û—á–∫–∏: " + score);
            } else {
                alert("–ò–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞!\n–û—á–∫–∏: " + score);
            }
        }
    }, 1000);
}
</script>

</body>
</html>
